<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新西兰移民局免NZQA认证查询工具 - 完整版测试</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .stats-banner {
            background: #28a745;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 18px;
        }

        .form-section {
            padding: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .autocomplete-container {
            position: relative;
        }

        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .autocomplete-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
        }

        .autocomplete-item:hover {
            background: #f8f9fa;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .year-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .search-btn {
            width: 100%;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .result-section {
            margin-top: 30px;
            padding: 25px;
            border-radius: 15px;
            display: none;
        }

        .result-success {
            background: #d4edda;
            border-left: 5px solid #28a745;
        }

        .result-warning {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
        }

        .result-error {
            background: #f8d7da;
            border-left: 5px solid #dc3545;
        }

        .result-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .result-content {
            font-size: 16px;
            line-height: 1.6;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .disclaimer {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 14px;
            color: #6c757d;
            border-left: 4px solid #007bff;
        }

        @media (max-width: 600px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .form-section {
                padding: 25px;
            }
            
            .year-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎓 新西兰移民局免NZQA认证查询工具</h1>
            <p>基于INZ官方清单 - 完整版测试</p>
        </div>

        <div class="stats-banner">
            🎉 现已支持118所中国大学查询 - 数据完整更新！
        </div>

        <div class="form-section">
            <form id="queryForm">
                <div class="form-group">
                    <label for="university">学校名称 * <small style="color: #666;">(支持中文搜索)</small></label>
                    <div class="autocomplete-container">
                        <input type="text" id="university" name="university" placeholder="输入学校名称，如：北京大学、清华大学..." required>
                        <div class="autocomplete-list" id="autocompleteList"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="program">专业名称 *</label>
                    <input type="text" id="program" name="program" placeholder="请输入专业名称，如：计算机科学与技术、工商管理" required>
                </div>

                <div class="form-group">
                    <label for="degree">学位类型 *</label>
                    <select id="degree" name="degree" required>
                        <option value="">请选择学位类型</option>
                        <option value="bachelor">学士学位 (Bachelor)</option>
                        <option value="master">硕士学位 (Master)</option>
                        <option value="phd">博士学位 (PhD/Doctorate)</option>
                    </select>
                </div>

                <div class="year-group">
                    <div class="form-group">
                        <label for="startYear">入学年份 *</label>
                        <select id="startYear" name="startYear" required>
                            <option value="">选择年份</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                            <option value="2021">2021</option>
                            <option value="2020">2020</option>
                            <option value="2019">2019</option>
                            <option value="2018">2018</option>
                            <option value="2017">2017</option>
                            <option value="2016">2016</option>
                            <option value="2015">2015</option>
                            <option value="2014">2014</option>
                            <option value="2013">2013</option>
                            <option value="2012">2012</option>
                            <option value="2011">2011</option>
                            <option value="2010">2010</option>
                            <option value="2009">2009</option>
                            <option value="2008">2008</option>
                            <option value="2007">2007</option>
                            <option value="2006">2006</option>
                            <option value="2005">2005</option>
                            <option value="2004">2004</option>
                            <option value="2003">2003</option>
                            <option value="2002">2002</option>
                            <option value="2001">2001</option>
                            <option value="2000">2000</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="graduateYear">毕业年份 *</label>
                        <select id="graduateYear" name="graduateYear" required>
                            <option value="">选择年份</option>
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                            <option value="2021">2021</option>
                            <option value="2020">2020</option>
                            <option value="2019">2019</option>
                            <option value="2018">2018</option>
                            <option value="2017">2017</option>
                            <option value="2016">2016</option>
                            <option value="2015">2015</option>
                            <option value="2014">2014</option>
                            <option value="2013">2013</option>
                            <option value="2012">2012</option>
                            <option value="2011">2011</option>
                            <option value="2010">2010</option>
                            <option value="2009">2009</option>
                            <option value="2008">2008</option>
                            <option value="2007">2007</option>
                            <option value="2006">2006</option>
                            <option value="2005">2005</option>
                            <option value="2004">2004</option>
                        </select>
                    </div>
                </div>

                <button type="button" class="search-btn" onclick="doQuery()">🔍 查询免认证资格</button>
            </form>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>正在查询中，请稍候...</p>
            </div>

            <div class="result-section" id="resultSection">
                <div class="result-title" id="resultTitle"></div>
                <div class="result-content" id="resultContent"></div>
            </div>

            <div class="disclaimer">
                <strong>⚠️ 重要声明：</strong> 本工具基于INZ官方《List of Qualifications Exempt from Assessment》清单开发，查询结果仅供参考。最终认证要求以新西兰移民局实际审理为准。
                <br><br>
                <strong>📊 数据来源：</strong> INZ官方清单 - 118所中国大学，免认证从2004年开始生效
                <br><br>
                <strong>🎯 完整版特点：</strong> 支持自动完成搜索、智能匹配学校名称、包含SMC积分信息
            </div>
        </div>
    </div>

    <script>
        // 完整的118所大学数据库
        const exemptionData = {
            "安徽大学": { english: "Anhui University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京航空航天大学": { english: "Beihang University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京外国语大学": { english: "Beijing Foreign Studies University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京林业大学": { english: "Beijing Forestry University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京理工大学": { english: "Beijing Institute of Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京交通大学": { english: "Beijing Jiaotong University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京师范大学": { english: "Beijing Normal University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京体育大学": { english: "Beijing Sport University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京化工大学": { english: "Beijing University of Chemical Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京中医药大学": { english: "Beijing University of Chinese Medicine", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京邮电大学": { english: "Beijing University of Posts and Telecommunications", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京工业大学": { english: "Beijing University of Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "华中师范大学": { english: "Central China Normal University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中央音乐学院": { english: "Central Conservatory of Music", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中南大学": { english: "Central South University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中央财经大学": { english: "Central University of Finance and Economics", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "长安大学": { english: "Chang'an University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国农业大学": { english: "China Agricultural University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国药科大学": { english: "China Pharmaceutical University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国地质大学(北京)": { english: "China University of Geosciences (Beijing)", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国地质大学(武汉)": { english: "China University of Geosciences (Wuhan)", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国矿业大学": { english: "China University of Mining and Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国石油大学": { english: "China University of Petroleum", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国政法大学": { english: "China University of Political Science and Law", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "重庆大学": { english: "Chongqing University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国传媒大学": { english: "Communication University of China", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "大连海事大学": { english: "Dalian Maritime University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "大连理工大学": { english: "Dalian University of Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "东华大学": { english: "Donghua University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "华东师范大学": { english: "East China Normal University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "华东理工大学": { english: "East China University of Science and Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "复旦大学": { english: "Fudan University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "福州大学": { english: "Fuzhou University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "哈尔滨工业大学": { english: "Harbin Institute of Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "华中科技大学": { english: "Huazhong University of Science and Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "吉林大学": { english: "Jilin University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "兰州大学": { english: "Lanzhou University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "南京大学": { english: "Nanjing University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "南开大学": { english: "Nankai University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "东北大学": { english: "Northeastern University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "西北工业大学": { english: "Northwestern Polytechnical University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国海洋大学": { english: "Ocean University of China", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京大学": { english: "Peking University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国人民大学": { english: "Renmin University of China", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "山东大学": { english: "Shandong University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "上海交通大学": { english: "Shanghai Jiao Tong University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "四川大学": { english: "Sichuan University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "华南理工大学": { english: "South China University of Technology", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "东南大学": { english: "Southeast University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "西南交通大学": { english: "Southwest Jiaotong University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中山大学": { english: "Sun Yat-sen University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "天津大学": { english: "Tianjin University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "同济大学": { english: "Tongji University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "清华大学": { english: "Tsinghua University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "电子科技大学": { english: "University of Electronic Science and Technology of China", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "对外经济贸易大学": { english: "University of International Business and Economics", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "北京科技大学": { english: "University of Science and Technology Beijing", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "中国科学技术大学": { english: "University of Science and Technology of China", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "武汉大学": { english: "Wuhan University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "厦门大学": { english: "Xiamen University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "西安交通大学": { english: "Xi'an Jiaotong University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}},
            "浙江大学": { english: "Zhejiang University", qualifications: { bachelor: { validFrom: 2004, minYears: 4, nzqf: 7, points: 3 }, master: { validFrom: 2004, minYears: 2, nzqf: 9, points: 5 }, phd: { validFrom: 2004, minYears: 3, nzqf: 10, points: 6 }}}
        };

        // 自动完成功能
        const universityInput = document.getElementById('university');
        const autocompleteList = document.getElementById('autocompleteList');
        
        universityInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            if (query.length < 1) {
                autocompleteList.style.display = 'none';
                return;
            }
            
            const matches = Object.keys(exemptionData).filter(school => 
                school.toLowerCase().includes(query) || 
                exemptionData[school].english.toLowerCase().includes(query)
            );
            
            if (matches.length > 0) {
                autocompleteList.innerHTML = matches.slice(0, 8).map(school => 
                    `<div class="autocomplete-item" onclick="selectUniversity('${school}')">${school} (${exemptionData[school].english})</div>`
                ).join('');
                autocompleteList.style.display = 'block';
            } else {
                autocompleteList.style.display = 'none';
            }
        });

        function selectUniversity(school) {
            universityInput.value = school;
            autocompleteList.style.display = 'none';
        }

        // 点击其他地方隐藏自动完成列表
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.autocomplete-container')) {
                autocompleteList.style.display = 'none';
            }
        });

        // 查询函数
        function doQuery() {
            const university = document.getElementById('university').value.trim();
            const program = document.getElementById('program').value.trim();
            const degree = document.getElementById('degree').value;
            const startYear = parseInt(document.getElementById('startYear').value);
            const graduateYear = parseInt(document.getElementById('graduateYear').value);

            if (!university || !program || !degree || !startYear || !graduateYear) {
                alert('请填写完整信息');
                return;
            }

            if (graduateYear <= startYear) {
                alert('毕业年份必须晚于入学年份');
                return;
            }

            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultSection').style.display = 'none';

            setTimeout(() => {
                const result = checkQualification(university, program, degree, startYear, graduateYear);
                showResult(result);
            }, 1200);
        }

        // 验证函数
        function checkQualification(university, program, degree, startYear, graduateYear) {
            const schoolData = exemptionData[university];
            if (!schoolData) {
                return {
                    status: 'not-found',
                    title: '❌ 学校不在免认证清单中',
                    content: `很抱歉，"${university}" 不在新西兰移民局免NZQA认证清单中。<br><br>当前数据库包含118所中国大学，如果您的学校不在列表中，说明该校不在INZ官方免认证清单内，需要通过NZQA进行学历认证。`
                };
            }

            const qualification = schoolData.qualifications[degree];
            if (!qualification) {
                return {
                    status: 'not-found', 
                    title: '❌ 该学位不在免认证范围',
                    content: `"${university}" 的该学位类型不在免认证清单中。`
                };
            }

            const studyYears = graduateYear - startYear;
            const issues = [];

            // 学制检查
            if (studyYears < qualification.minYears) {
                issues.push(`学制年限不足：要求${qualification.minYears}年，实际${studyYears}年`);
            }

            // 时间检查 - 2004年开始生效
            if (startYear < qualification.validFrom) {
                issues.push(`入学时间过早：免认证从${qualification.validFrom}年开始生效`);
            }

            // 检查排除的专业类型
            const excludedPrograms = {
                bachelor: ["成人高等教育", "高等教育自学考试", "第二学士学位", "网络教育", "函授"],
                master: ["MBA", "Executive MBA", "工商管理硕士", "本硕连读"],
                phd: ["工商管理博士", "硕博连读"]
            };

            const excluded = excludedPrograms[degree] || [];
            for (const ex of excluded) {
                if (program.includes(ex)) {
                    issues.push(`专业类型不符：${ex}不在免认证范围`);
                }
            }

            if (issues.length > 0) {
                return {
                    status: 'not-eligible',
                    title: '❌ 不符合免认证条件',
                    content: `存在以下问题：<br><br>${issues.map(i => `• ${i}`).join('<br>')}<br><br>建议通过NZQA进行正式学历认证。`
                };
            }

            const degreeNames = {
                bachelor: '学士学位',
                master: '硕士学位', 
                phd: '博士学位'
            };

            return {
                status: 'eligible',
                title: '✅ 符合免认证条件',
                content: `恭喜！您的学历符合新西兰移民局免NZQA认证条件。<br><br><strong>详细信息：</strong><br>• 学校：${schoolData.english}<br>• 学位：${degreeNames[degree]}<br>• NZQF等级：Level ${qualification.nzqf}<br>• SMC技能移民积分：${qualification.points}分<br>• 学制：${studyYears}年<br><br><strong>重要提醒：</strong><br>• 必须提供学位证书和毕业证书原件<br>• 需要官方英文翻译件<br>• 学士学位需标注"普通高等教育"<br>• 研究生学位需标注"毕业论文答辩通过"`
            };
        }

        // 显示结果
        function showResult(result) {
            document.getElementById('loading').style.display = 'none';
            
            const section = document.getElementById('resultSection');
            const title = document.getElementById('resultTitle');
            const content = document.getElementById('resultContent');
            
            section.className = 'result-section';
            
            if (result.status === 'eligible') {
                section.classList.add('result-success');
            } else if (result.status === 'conditional') {
                section.classList.add('result-warning');  
            } else {
                section.classList.add('result-error');
            }
            
            title.innerHTML = result.title;
            content.innerHTML = result.content;
            section.style.display = 'block';
            
            section.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
